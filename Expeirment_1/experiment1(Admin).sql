
-- CREATE table players(
--   ID Serial,
--   FirstName Text,
--   LastName Text,
--   Score Int,
--   Age Int check(Age>=13),
--   rank_ Int Unique NOT NULL
--  );
 
-- INSERT INTO players (FirstName, LastName, Score,age,rank_) 
-- VALUES ('John', 'Doe', 10,14,3);
-- INSERT INTO players (FirstName, LastName, Score,age,rank_)
-- VALUES ('Alice', 'Smith', 15,14,2);
-- INSERT INTO players (FirstName, LastName, Score,age,rank_) 
-- VALUES ('Bob', 'Johnson', 20,13,1);
-- select * from players;

-- UNIQUE
-- NOT NULL
-- WHERE
-- INSERT 
-- DELETE 
-- UPDATE



-- CREATE TABLE EMPLOYEES(
-- EMP_ID INT PRIMARY KEY,
-- EMP_NAME VARCHAR(20),
-- AGE INT CHECK(AGE>=18),
-- EMAIL VARCHAR(20) UNIQUE,
-- MOBILE_NUMBER  INT UNIQUE
-- );


-- INSERT INTO  EMPLOYEES(EMP_ID,EMP_NAME,AGE,EMAIL,MOBILE_NUMBER) 
-- VALUES(106,'AKASH',18,'ABC@GMAIL.COM',123);

-- INSERT INTO  EMPLOYEES(EMP_ID,EMP_NAME,AGE,EMAIL,MOBILE_NUMBER) 
-- VALUES(102,'VIAKS',19,'C@GMAIL.COM',1234);


-- INSERT INTO  EMPLOYEES(EMP_ID,EMP_NAME,AGE,EMAIL,MOBILE_NUMBER) 
-- VALUES(104,NULL,19,'CS@GMAIL.COM',12348);


-- SELECT EMP_NAME FROM  EMPLOYEES
-- WHERE EMP_ID=102;


-- UPDATE EMPLOYEES
-- SET EMP_NAME='VIJAY'
-- WHERE EMP_ID=104;


-- DELETE FROM EMPLOYEES
-- WHERE EMP_ID =104;


Create table if not exists books(
ID int primary key,
Name varchar(20) not null,
Author_Name Varchar(20) not null
);


ALTER TABLE books
ADD COLUMN IF NOT EXISTS book_count INT CHECK (book_count >= 1);


update books
set book_count = 3
where id = 1;
select * from books;


create table if not exists LIBRARY_VISITOR_USER
(
USER_ID INT PRIMARY KEY,
USER_NAME VARCHAR(20),
USER_AGE INT CHECK(USER_AGE>=17),
USER_EMAIL VARCHAR(20) UNIQUE NOT NULL
);

INSERT INTO LIBRARY_VISITOR_USER(USER_ID,USER_NAME,USER_AGE,USER_EMAIL)
VALUES(101,'UTKARSH',20,'UTKARSH@GMAIL.COM');

SELECT * FROM LIBRARY_VISITOR_USER;

-- drop email

ALTER TABLE LIBRARY_VISITOR_USER
DROP COLUMN USER_EMAIL;
SELECT * FROM LIBRARY_VISITOR_USER;

-- CHANGE SIZE

ALTER TABLE LIBRARY_VISITOR_USER
ADD COLUMN USER_EMAIL VARCHAR(30) UNIQUE;
SELECT * FROM LIBRARY_VISITOR_USER;

-- ADD EMAIL AGAIN
UPDATE LIBRARY_VISITOR_USER
SET USER_EMAIL = 'UTKARSH@GMAIL.COM'
WHERE USER_ID = 101;

SELECT * FROM LIBRARY_VISITOR_USER;
-- add book issue table
CREATE TABLE BOOK_ISSUE(
BOOK_ISSUE_ID INT PRIMARY KEY,
BOOK_ID INT REFERENCES books(ID) NOT NULL,
USER_ID INT REFERENCES LIBRARY_VISITOR_USER(USER_ID) NOT NULL,
BOOK_ISSUE DATE NOT NULL
);

INSERT INTO BOOK_ISSUE VALUES(5552,1,101,CURRENT_DATE);
SELECT * FROM BOOK_ISSUE;

-- add role

CREATE ROLE LIBRARIAN
WITH LOGIN PASSWORD 'ROOT'

Grant SELECT, INSERT, DELETE,UPDATE ON books TO LIBRARIAN;
Grant SELECT, INSERT, DELETE,UPDATE ON BOOK_ISSUE TO LIBRARIAN;
Grant SELECT, INSERT, DELETE,UPDATE ON LIBRARY_VISITOR_USER TO LIBRARIAN;

-- revoke
REVOKE SELECT, INSERT, DELETE,UPDATE ON books FROM LIBRARIAN;
